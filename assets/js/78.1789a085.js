(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{429:function(s,a,t){"use strict";t.r(a);var e=t(7),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("服务器每天关机，每次都得手动重启服务，烦死了！要不整个自启吧。")]),s._v(" "),a("p",[s._v("研究了下大概有4种方式：")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#%E6%B3%A8%E5%86%8C%E6%9C%8D%E5%8A%A1"}},[s._v("注册服务")])]),s._v(" "),a("li",[a("a",{attrs:{href:"#chkconfig"}},[s._v("chkconfig")])]),s._v(" "),a("li",[a("a",{attrs:{href:"#initd%E7%9B%AE%E5%BD%95%E4%B8%8B%E6%94%BE%E7%BD%AE%E8%84%9A%E6%9C%AC"}},[s._v("/etc/init.d")]),s._v(" 目录下放置脚本")]),s._v(" "),a("li",[a("a",{attrs:{href:"#rclocal%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99%E5%91%BD%E4%BB%A4"}},[s._v("/etc/rc.d/rc.local")]),s._v(" 文件编写命令\n")])]),s._v(" "),a("h2",{attrs:{id:"注册服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注册服务"}},[s._v("#")]),s._v(" 注册服务")]),s._v(" "),a("p",[s._v("在Centos 中 systemctl  是设置系统服务的命令，\n即 service, 它融合之前service和chkconfig的功能于一体。\n可以使用它永久性或只在当前会话中启用/禁用服务。")]),s._v(" "),a("p",[s._v("编写服务 "),a("code",[s._v("test.service")])]),s._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[Unit]\nDescription=Test Server Name\nAfter=network.target\n\n[Service]\nType=simple\nUser=nobody\nRestart=on-failure\nRestartSec=5s\nExecStart= 需要执行的命令\n\n[Install]\nWantedBy=multi-user.target\n")])])]),a("p",[s._v("复制到 "),a("code",[s._v("/usr/lib/systemd/system/")]),s._v(" 目录下")]),s._v(" "),a("h3",{attrs:{id:"相关命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关命令"}},[s._v("#")]),s._v(" 相关命令")]),s._v(" "),a("h4",{attrs:{id:"启动服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动服务"}},[s._v("#")]),s._v(" 启动服务")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl start  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])])]),a("h4",{attrs:{id:"停止"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#停止"}},[s._v("#")]),s._v(" 停止")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl stop  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])])]),a("h4",{attrs:{id:"查看服务状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看服务状态"}},[s._v("#")]),s._v(" 查看服务状态")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl status  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])])]),a("h4",{attrs:{id:"重启服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重启服务"}},[s._v("#")]),s._v(" 重启服务")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl reload  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])])]),a("h4",{attrs:{id:"启用服务自启"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启用服务自启"}},[s._v("#")]),s._v(" 启用服务自启")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])])]),a("h4",{attrs:{id:"禁用服务自启"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#禁用服务自启"}},[s._v("#")]),s._v(" 禁用服务自启")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl disable  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\n")])])]),a("h4",{attrs:{id:"查看系统服务列表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看系统服务列表"}},[s._v("#")]),s._v(" 查看系统服务列表")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl list-unit-files –type"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("service\n")])])]),a("h4",{attrs:{id:"重载系统服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重载系统服务"}},[s._v("#")]),s._v(" 重载系统服务")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl daemon-reload\n")])])]),a("h2",{attrs:{id:"chkconfig"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#chkconfig"}},[s._v("#")]),s._v(" chkconfig")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/6844904104515338248",target:"_blank",rel:"noopener noreferrer"}},[s._v("tetschkconfig"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注册系统服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--add")]),s._v(" service.sh\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除系统服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--del")]),s._v(" service.sh\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置开机启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" service.sh on\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看系统服务列表")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--list")]),s._v("\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" service.sh start\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#停止服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" service.sh stop\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" service.sh restart\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#服务状态")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" service.sh status\n")])])]),a("h2",{attrs:{id:"initd目录下放置脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#initd目录下放置脚本"}},[s._v("#")]),s._v(" initd目录下放置脚本")]),s._v(" "),a("h3",{attrs:{id:"相关命令-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关命令-2"}},[s._v("#")]),s._v(" 相关命令")]),s._v(" "),a("h4",{attrs:{id:"设置执行权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置执行权限"}},[s._v("#")]),s._v(" 设置执行权限")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x  service.sh\n")])])]),a("h4",{attrs:{id:"移动到目录下"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#移动到目录下"}},[s._v("#")]),s._v(" 移动到目录下")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" service.sh /etc/init.d/\n")])])]),a("h2",{attrs:{id:"rc-local文件编写命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rc-local文件编写命令"}},[s._v("#")]),s._v(" rc.local文件编写命令")]),s._v(" "),a("p",[s._v("rc.local是CentOS以前版本的方式，在CentOS7中仍然以兼容的形式存在，虽仍可用，但不推荐（推荐使用systemd service")]),s._v(" "),a("h3",{attrs:{id:"相关命令-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关命令-3"}},[s._v("#")]),s._v(" 相关命令")]),s._v(" "),a("h4",{attrs:{id:"设置执行权限-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置执行权限-2"}},[s._v("#")]),s._v(" 设置执行权限")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x  rc.local\n")])])]),a("h4",{attrs:{id:"编辑rc-local"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编辑rc-local"}},[s._v("#")]),s._v(" 编辑"),a("code",[s._v("rc.local")])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[s._v("在文件内写入自己要执行的命令，命令尽量使用后台运行命令，不要使用挂起命令，可能会影响系统启动。")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v("  /etc/rc.d/rc.local\n")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);