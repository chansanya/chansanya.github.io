(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{440:function(s,t,a){"use strict";a.r(t);var r=a(8),e=Object(r.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("GB35114 简单理解")]),s._v(" "),t("details",{staticClass:"custom-block details"},[t("summary",[s._v("示例数据")]),s._v(" "),t("blockquote",[t("p",[s._v("SIP上级平台信息")]),s._v(" "),t("p",[s._v("SIP服务编码： 11010000002000000001")]),s._v(" "),t("p",[s._v("SIP服务域： 1101000000")]),s._v(" "),t("p",[s._v("SIP服务IP：10.2.64.180")]),s._v(" "),t("p",[s._v("SIP服务端口：5060")])]),s._v(" "),t("blockquote",[t("p",[s._v("SIP下级信息")]),s._v(" "),t("p",[s._v("设备SIP编码: 11010000001320000211")]),s._v(" "),t("p",[s._v("设备SIP域: 1101000000")]),s._v(" "),t("p",[s._v("设备IP: 10.2.64.101")]),s._v(" "),t("p",[s._v("设备SIP端口: 5060")])])]),s._v(" "),t("h2",{attrs:{id:"注册"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注册"}},[s._v("#")]),s._v(" 注册")]),s._v(" "),t("h3",{attrs:{id:"单向认证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#单向认证"}},[s._v("#")]),s._v(" 单向认证")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/35114/1.png",alt:"img.png"}})]),s._v(" "),t("h4",{attrs:{id:"流程示意图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#流程示意图"}},[s._v("#")]),s._v(" 流程示意图")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/35114/1-1.png",alt:"img.png"}}),s._v(" "),t("img",{attrs:{src:"/img/35114/1-2.png",alt:"img.png"}})]),s._v(" "),t("details",{staticClass:"custom-block details"},[t("summary",[s._v("信令")]),s._v(" "),t("h4",{attrs:{id:"_1-首次注册"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-首次注册"}},[s._v("#")]),s._v(" 1.首次注册")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("REGISTER sip:11010000002000000001@10.2.64.180:5060 SIP/2.0\nVia: SIP/2.0/UDP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".64.101:5060"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("rport"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("z9hG4bK339559691\nFrom: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tag")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("552151529")]),s._v("\nTo: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("\nCall-ID: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1642492311")]),s._v("\nCSeq: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" REGISTER\nContact: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("\nMax-Forwards: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("70")]),s._v("\nUser-Agent: agent\nExpires: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),s._v("\nAuthorization: Capability  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("algorithm")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A:SM2;H:SM3;S:SM4/OFB/PKCS5;SI:SM3-SM2"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("keyversion")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2021-06-11T14:21:34"')]),s._v("\nContent-Length: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("添加头 "),t("code",[s._v("Authorization 值（Scheme）Capability")]),s._v(":")]),s._v(" "),t("p",[s._v("携带参数：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v('algorithm "A:SM2;H:SM3;S:SM4/OFB/PKCS5;SI:SM3-SM2"')]),s._v(" "),t("ul",[t("li",[s._v("A : 非对称算法描述,取值为设备支持的非对称算法，多种算法之间用逗号分隔。 例如：A:SM2;")]),s._v(" "),t("li",[s._v("H : 杂凑算法描述,取值为设备支持的杂凑算法，多种算法之间用逗号分隔。 例如：H:SM3")]),s._v(" "),t("li",[s._v("S : 对称算法描述，取值为设备支持的对称算法／模式／填充方式，多种算法之间用逗号分隔。 例如：S:SM4/OFB/PKCS5")]),s._v(" "),t("li",[s._v("SI : 签名算法的描述。 例如：SI:SM3-SM2")])])]),s._v(" "),t("li",[t("p",[s._v("keyversion : 秘钥版本")])])]),s._v(" "),t("h4",{attrs:{id:"_2-响应401"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-响应401"}},[s._v("#")]),s._v(" 2.响应401")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("SIP/2.0 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("401")]),s._v(" Unauthorized\nVia: SIP/2.0/UDP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".64.101:5060"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rport")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5060")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("z9hG4bK339559691\nFrom: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tag")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("552151529")]),s._v("\nTo: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tag")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2050236306")]),s._v("\nCall-ID: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1642492311")]),s._v("\nCSeq: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" REGISTER\nUser-Agent: JCZX-GBVAG\nWWW-Authenticate: Unidirection "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("algorithm")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A:SM2;H:SM3;S:SM4/OFB/PKCS5;SI:SM3-SM2"')]),s._v(",random1"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NjcwMDY3NjcwMDY3NjcwMDY3NjcwMDY3"')]),s._v("\nContent-Length: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("添加头 "),t("code",[s._v("WWW-Authenticate 值（Scheme）Unidirection")])]),s._v(" "),t("p",[s._v("携带参数：")]),s._v(" "),t("ul",[t("li",[s._v("random1 ： SIP服务器随机数")]),s._v(" "),t("li",[s._v("algorithm ： 服务器使用的安全算法")])]),s._v(" "),t("h4",{attrs:{id:"_3-再次注册"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-再次注册"}},[s._v("#")]),s._v(" 3.再次注册")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("REGISTER sip:11010000002000000001@10.2.64.180:5060 SIP/2.0\nVia: SIP/2.0/UDP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".64.101:5060"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("rport"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("z9hG4bK819567731\nFrom: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tag")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("552151529")]),s._v("\nTo: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("\nCall-ID: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1642492311")]),s._v("\nCSeq: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" REGISTER\nContact: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("\nMax-Forwards: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("70")]),s._v("\nUser-Agent: agent\nExpires: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),s._v("\nAuthorization: Unidirection "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("algorithm")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A:SM2;H:SM3;S:SM4/OFB/PKCS5,SM1/OFB/PKCS5;SI:SM3-SM2"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sign1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MEUCIEKmV87g1h4+0q1oYek6imcwrhHanuWEvdxpHGlJWVtNAiEAou0BOVldDJhHIprbtmAPxNFs3kWnJwe2twKmFwttNAI="')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("random2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CTcRaIUdJ9xgiNV+sCjxGw=="')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("random1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NjcwMDY3NjcwMDY3NjcwMDY3NjcwMDY3"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("serverid")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"11010000002000000001"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("deviceid")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"11010000001320000211"')]),s._v("\nContent-Length: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("添加头 "),t("code",[s._v("Authorization 值（Scheme）Unidirection")])]),s._v(" "),t("p",[s._v("携带参数：")]),s._v(" "),t("ul",[t("li",[s._v("algorithm 采用的安全算法")]),s._v(" "),t("li",[s._v("sign1  "),t("code",[s._v("sign(random2+random1+serverid)")])]),s._v(" "),t("li",[s._v("random2 FDWSF生成随机数")]),s._v(" "),t("li",[s._v("random1 SIP服务器随机数")]),s._v(" "),t("li",[s._v("serverid SIP服务器ID")])]),s._v(" "),t("h4",{attrs:{id:"_4-注册成功"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-注册成功"}},[s._v("#")]),s._v(" 4.注册成功")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("SIP/2.0 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" OK\nVia: SIP/2.0/UDP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".64.101:5060"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rport")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5060")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("z9hG4bK819567731\nFrom: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tag")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("552151529")]),s._v("\nTo: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tag")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("958442107")]),s._v("\nCall-ID: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1642492311")]),s._v("\nCSeq: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" REGISTER\nUser-Agent: JCZX-GBVAG\nSecurityInfo: Unidirection "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("cryptkey")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MHkCIQCfe8tHLkEsunWqxM+L8P+eJmSv9/Ofc1ZcZ2m/Lu5E8wIgLcEDgu1vAuetlgtYh3E61vY6L7WjhkWeNYZgdQXCN2EEIBHnR/qvF1D4y39oHnLR+4HxkK7fty53BAQj9/Voo3dTBBALVg5CJSKiOrUnu3n/pKaT"')]),s._v(",algorithm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A:SM2;H:SM3"')]),s._v("\nDate: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-06-11T14:21:35.100\nExpires: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),s._v("\nContent-Length: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("响应头 "),t("code",[s._v("SecurityInfo 值（Scheme）Unidirection")])]),s._v(" "),t("p",[s._v("携带参数：")]),s._v(" "),t("ul",[t("li",[s._v("cryptkey  "),t("code",[s._v("base64(VKEK公钥加密)")])]),s._v(" "),t("li",[s._v("algorithm  采用的安全算法")])])]),s._v(" "),t("h3",{attrs:{id:"双向认证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#双向认证"}},[s._v("#")]),s._v(" 双向认证")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/35114/2.png",alt:"img.png"}})]),s._v(" "),t("h4",{attrs:{id:"流程示意图-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#流程示意图-2"}},[s._v("#")]),s._v(" 流程示意图")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/35114/2-1.png",alt:"img.png"}}),s._v(" "),t("img",{attrs:{src:"/img/35114/2-2.png",alt:"img.png"}})]),s._v(" "),t("details",{staticClass:"custom-block details"},[t("summary",[s._v("信令")]),s._v(" "),t("h4",{attrs:{id:"_1-首次注册-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-首次注册-2"}},[s._v("#")]),s._v(" 1.首次注册")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("REGISTER sip:11010000002000000001@10.2.64.180:5060 SIP/2.0\nVia: SIP/2.0/UDP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".64.101:5060"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("rport"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("z9hG4bK1486647237\nFrom: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tag")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2046396740")]),s._v("\nTo: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("\nCall-ID: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1790410176")]),s._v("\nCSeq: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" REGISTER\nContact: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("\nMax-Forwards: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("70")]),s._v("\nUser-Agent: agent\nExpires: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),s._v("\nAuthorization: Capability  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("algorithm")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A:SM2;H:SM3;S:SM4/OFB/PKCS5;SI:SM3-SM2"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("keyversion")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2021-06-11T14:26:11"')]),s._v("\nContent-Length: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("同单向认证")]),s._v(" "),t("h4",{attrs:{id:"_2-响应401-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-响应401-2"}},[s._v("#")]),s._v(" 2.响应401")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("SIP/2.0 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("401")]),s._v(" Unauthorized\nVia: SIP/2.0/UDP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".64.101:5060"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rport")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5060")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("z9hG4bK1486647237\nFrom: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tag")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2046396740")]),s._v("\nTo: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tag")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("520744638")]),s._v("\nCall-ID: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1790410176")]),s._v("\nCSeq: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" REGISTER\nUser-Agent: JCZX-GBVAG\nWWW-Authenticate: Bidirection "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("algorithm")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A:SM2;H:SM3;S:SM4/OFB/PKCS5;SI:SM3-SM2"')]),s._v(",random1"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MmUwMDJlMmUwMDJlMmUwMDJlMmUwMDJl"')]),s._v("\nContent-Length: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("添加头 "),t("code",[s._v("WWW-Authenticate 值（Scheme）Bidirection")])]),s._v(" "),t("p",[s._v("携带参数：")]),s._v(" "),t("ul",[t("li",[s._v("random1 ： SIP服务器随机数")]),s._v(" "),t("li",[s._v("algorithm ： 服务器使用的安全算法")])]),s._v(" "),t("h4",{attrs:{id:"_3-再次注册-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-再次注册-2"}},[s._v("#")]),s._v(" 3.再次注册")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("REGISTER sip:11010000002000000001@10.2.64.180:5060 SIP/2.0\nVia: SIP/2.0/UDP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".64.101:5060"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("rport"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("z9hG4bK1410715500\nFrom: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tag")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2046396740")]),s._v("\nTo: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("\nCall-ID: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1790410176")]),s._v("\nCSeq: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" REGISTER\nContact: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),s._v("\nMax-Forwards: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("70")]),s._v("\nUser-Agent: agent\nExpires: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),s._v("\nAuthorization: Bidirection "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("algorithm")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A:SM2;H:SM3;S:SM4/OFB/PKCS5,SM1/OFB/PKCS5;SI:SM3-SM2"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sign1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MEYCIQCrEAEaOLtBrfAypnRWyH4sCrTkr0hcTATyGq+3IDacvQIhANIN5hRvvnn4emg6Gk33UkeP71LDF6uTigoFHOjAzCfS"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("random2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5n6TL3SAh90tENzdalRFDg=="')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("random1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MmUwMDJlMmUwMDJlMmUwMDJlMmUwMDJl"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("serverid")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"11010000002000000001"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("deviceid")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"11010000001320000211"')]),s._v("\nContent-Length: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("添加头 "),t("code",[s._v("Authorization 值（Scheme）Bidirection")]),s._v(":")]),s._v(" "),t("p",[s._v("携带参数：")]),s._v(" "),t("ul",[t("li",[s._v("algorithm 采用的安全算法")]),s._v(" "),t("li",[s._v("sign1  "),t("code",[s._v("sign(random2+random1+serverid)")])]),s._v(" "),t("li",[s._v("random2 FDWSF生成随机数")]),s._v(" "),t("li",[s._v("random1 SIP服务器随机数")]),s._v(" "),t("li",[s._v("serverid SIP服务器ID")])]),s._v(" "),t("h4",{attrs:{id:"_4-注册成功-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-注册成功-2"}},[s._v("#")]),s._v(" 4.注册成功")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("SIP/2.0 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" OK\nVia: SIP/2.0/UDP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.2")]),s._v(".64.101:5060"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rport")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5060")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("branch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("z9hG4bK1410715500\nFrom: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tag")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2046396740")]),s._v("\nTo: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("sip:11010000001320000211@10.2.64.101:506"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("0")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("tag")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1509534134")]),s._v("\nCall-ID: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1790410176")]),s._v("\nCSeq: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" REGISTER\nUser-Agent: JCZX-GBVAG\nSecurityInfo: Bidirection "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("random1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MmUwMDJlMmUwMDJlMmUwMDJlMmUwMDJl"')]),s._v(",random2"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5n6TL3SAh90tENzdalRFDg=="')]),s._v(",deviceid"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"11010000001320000211"')]),s._v(",cryptkey"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MHkCIQCfe8tHLkEsunWqxM+L8P+eJmSv9/Ofc1ZcZ2m/Lu5E8wIgLcEDgu1vAuetlgtYh3E61vY6L7WjhkWeNYZgdQXCN2EEIJDOIrrHKjogmak5o4tbslsLjXMgxXS14l1ILfuwSt6KBBAOXg5CICqnMrUnvnH6rKaT"')]),s._v(",sign2"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MEQCIF9wHGMwj+aoR/5UwENOpRH+4TTOftFYr5c6p0SCjvi8AiAmkRfeJ6bW5cQYkWf6HQMVe9LwT/rCTcer4NOSUSBqpw=="')]),s._v(",algorithm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A:SM2;H:SM3;S:SM4/OFB/PKCS5;SI:SM3-SM2"')]),s._v("\nDate: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-06-11T14:26:12.100\nExpires: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),s._v("\nContent-Length: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("p",[s._v("响应头 "),t("code",[s._v("SecurityInfo 值（Scheme）Bidirection")])]),s._v(" "),t("p",[s._v("携带参数")]),s._v(" "),t("ul",[t("li",[s._v("cryptkey = "),t("code",[s._v("base64(VKEK公钥加密)")])]),s._v(" "),t("li",[s._v("random1 SIP服务器随机数")]),s._v(" "),t("li",[s._v("random2 FDWSF生成随机数")]),s._v(" "),t("li",[s._v("deviceid FDWSF ID")]),s._v(" "),t("li",[s._v("serverid SIP服务器ID")]),s._v(" "),t("li",[s._v("algorithm 采用的安全算法")]),s._v(" "),t("li",[s._v("sign2 = "),t("code",[s._v("sign(random1+random2+deviceid+cryptkey)")])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);