---
title: WSL使用
date: 2024-11-27 09:00:00
permalink: /pages/wsl-usage/
categories:
  - 知识库
  - 其他
  - 环境搭建
tags:
  - WSL
  - Windows
  - Linux
  - 开发环境
author:
  name: YAN
  link: https://github.com/chansanya
---

## WSL 简介

Windows Subsystem for Linux (WSL) 允许在 Windows 上直接运行 Linux 环境，无需虚拟机。

## 安装 WSL

### 方法一：命令行安装（推荐）

```powershell
# 安装默认的 Ubuntu 发行版
wsl --install

# 或者指定发行版
wsl --install -d Ubuntu-22.04
```


## 常用 WSL 命令

### 系统管理
```bash
# 查看已安装的发行版
wsl --list --verbose

# 设置默认发行版
wsl --set-default Ubuntu-22.04

# 停止 WSL 服务
wsl --shutdown

# 导出发行版
wsl --export Ubuntu-22.04 ubuntu-backup.tar

# 导入发行版
wsl --import Ubuntu-22.04 C:\\WSL\\Ubuntu-new ubuntu-backup.tar

# 或者替换现有发行版（先取消注册再导入）
wsl --unregister Ubuntu-22.04
wsl --import Ubuntu-22.04 C:\\WSL\\Ubuntu-new ubuntu-backup.tar

```

### 版本管理
```bash
# 设置 WSL 版本
wsl --set-version Ubuntu-22.04 2

# 查看版本信息
wsl --status
```

## WSL 配置

### 修改默认用户
```bash
# 在 WSL 中执行
sudo nano /etc/wsl.conf
```

添加以下内容：
```ini
[user]
[wsl2]
memory=32GB
#swap=8GB
processors=16
#nat模式
#localhostForwarding=true

[experimental]
autoMemoryReclaim=gradual
#Mirrored 模式
networkingMode=mirrored
dnsTunneling=true
firewall=true
autoProxy=true
sparseVhd=true
```

### 固定 IP 地址
```bash
# 查看 WSL IP 地址
ip addr show eth0
```

### 配置 Git
```bash
git config --global user.name "Your Name"
git config --global user.email "your-email@example.com"
```

## 常见问题解决

### WSL 启动失败
```powershell
# 重置 WSL
wsl --unregister Ubuntu-22.04
wsl --install -d Ubuntu-22.04
```

### 磁盘空间不足
```bash
# 清理包缓存
sudo apt autoclean
sudo apt autoremove

# 查看磁盘使用情况
df -h
```

## 备份与恢复

### 定期备份
```powershell
# 导出当前 WSL 实例
wsl --export Ubuntu-22.04 ubuntu-backup-$(Get-Date -Format "yyyyMMdd").tar
```

### 恢复备份
```powershell
# 导入备份文件
wsl --import Ubuntu-restored C:\\WSL\\Ubuntu-restored ubuntu-backup.tar
```